# daily  Встреча я, Абрамов, Кузнецов

Есть уровень доступа к данным (JPA), и есть репозиторий бизнес-сущностей и аггрегатов
У меня вечная сложность, как их именовать (репозиторий, сервис)

Сервис возвратов не должен поддерживать произвольное сохранение данных поручения из BPMN. 
С поручением можно делать только те операции, которые предусмотрены бизнес-моделью. При попытке сделать операцию, 
не предусмотренную моделью, процесс встает и ждет, пока либо эту операцию реализуют, либо ... ну вобщем понятно

Таким образом поручение живет в сервисе возвратов

~~`Работа через заказ по этой схеме, либо чревата лишним get/save операциями, либо модель должна быть хитрой:
 ленивой или с возможностью не полной инициализации + запоминать, что было изменено в результате операции.

   - на шаге создания поручения не нужно тащить поручения
   - на шаге запуска поручения не нужны платежи (билеты надо еще раз получить и проверить). Но нужны другие поручения
в статусе "Исполняются"
   - на стадии обновления статуса поручения нужно только поручение, от заказа не нужно ничего
Я никогда в таком стиле не работал.`~~

Механизм логирования
 - Order имеет поле log: [{returnOrderID, Object}] при операциях над заказом поле заполняется
 - Над orderService висит аспект, который читает лог и сохраняет его в ассоциации с текущей сессией

Не пора ли liqubase прикрутить.



